(function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(b,c){var d,e,f,g;if(this.config=b,this.actionStack=c,this.dirtyCells=[],this.dirtyRows=[],this.copiedGridChange=this.config.copiedGridChange,this.uniqueValueKey=this.config.uniqueValueKey,this.rowIndex=this.config.rowIndex,this.useFixedHeaders=this.config.useFixedHeaders,this.element=document.querySelectorAll(this.config.element||"#gridedit")[0],this.contextMenu=new a.ContextMenu(this),this.themeName=this.config.themeName,this.customTheme=this.config.themeTemplate,this.theme=new a.Theme(this.themeName,this.customTheme),this.draggingRow=null,this.lastDragOver=null,this.lastDragOverIsBeforeFirstRow=!1,this.lastClickCell=null,this.headers=[],this.rows=[],this.subtotalRows=[],this.cols=[],this.source=this.config.rows,this.redCells=[],this.activeCells=[],this.copiedCells=null,this.selectionStart=null,this.selectionEnd=null,this.selectedCol=null,this.openCell=null,this.state="ready",this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.topOffset=this.config.topOffset?this.config.topOffset:0,this.config.custom){f=this.config.custom;for(e in f)g=f[e],e in this.config.custom&&this.set(e,g);delete this.config.custom}this.config.initialize&&this.init(),this.actionStack||(this.actionStack=new a.ActionStack(this)),this.config.selectedCell&&(d=this.getCell(this.config.selectedCell[0],this.config.selectedCell[1]),d&&d.makeActive(),this.config.selectedCell=void 0)}return a.prototype.init=function(){this.config.beforeInit&&this.config.beforeInit(),a.Hook.prototype.initTableHooks(this),this.build(),this.events(),this.render(),this.removeBrowserHighlighting(),this.rowIndex||this.setRowIndexes(),this.config.afterInit&&this.config.afterInit()},a.prototype.setRowIndexes=function(){var a,b,c,d,e,f,g;if(!this.config.uniqueValueKey)return!1;for(f={},g=this.config.uniqueValueKey,d=this.source,a=b=0,c=d.length;c>b;a=++b)e=d[a],f[a]=e[g];return this.rowIndex=f},a.prototype.removeBrowserHighlighting=function(){var a,b,c,d,e;for(e=["-webkit-touch-callout","-webkit-user-select","-khtml-user-select","-moz-user-select","-ms-user-select","user-select"],c=[],a=0,b=e.length;b>a;a++)d=e[a],c.push(this.tableEl.style[d]="none");return c},a.prototype.build=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(r=document.createElement("tr"),this.config.includeRowHandles&&(e=document.createElement("th"),r.appendChild(e)),k=this.config.cols,f=g=0,i=k.length;i>g;f=++g)c=k[f],b=new a.Column(c,this),this.cols.push(b),r.appendChild(b.element);for(this.thead=document.createElement("thead"),d=this,this.thead.ondragenter=function(){var a;return d.lastDragOverIsBeforeFirstRow=!0,a=d.lastDragOver,a?(a.element.style.borderBottom=a.oldBorderBottom,a.element.style.borderTop=d.theme.borders.dragBorderStyle):void 0},this.thead.ondragleave=function(){var a;return a=d.rows[0],a.element.style.borderTop=a.oldBorderTop},this.thead.appendChild(r),q=document.createElement("tbody"),l=this.source,f=h=0,j=l.length;j>h;f=++h){switch(n=l[f],n.gridEditRowType){case"static":m=new a.StaticRow(n,this);break;case"subtotal":m=new a.SubTotalRow(n,this);break;case"heading":m=new a.HeaderRow(n,this);break;case"custom":o=n.customClassName||"GenericRow",m=new a[o](n,this);break;default:m=new a.GenericRow(n,this)}this.rows.push(m),q.appendChild(m.element)}return p=document.createElement("table"),a.Utilities.prototype.setAttributes(p,{id:"editable-grid","class":this.config.tableClass}),p.appendChild(this.thead),p.appendChild(q),this.tableEl=p,this.useFixedHeaders?(this.element.style.overflowY="scroll",a.Utilities.prototype.fixHeaders(this),window.addEventListener("resize",function(){return a.Utilities.prototype.fixHeaders(d)})):void 0},a.prototype.rebuild=function(a){var b,c,d,e;if(null==a&&(a=null),this.contextMenu.hide(),c=Object.create(this.config),c.rowIndex=this.rowIndex,null!==a)for(d in a)e=a[d],c[d]=a[d];return c.copiedGridChange=this.copiedGridChange,b=this.actionStack,this.destroy(),this.constructor(c,b)},a.prototype.hideControl=function(){return this.openCell?this.openCell.edit(this.openCell.control.value):void 0},a.prototype.events=function(){var b;return b=this,document.onkeydown=function(a){var d,e,f,g,h;if(b.activeCell())if(g=a.keyCode,h=a.shiftKey,f=a.ctrlKey,e=a.metaKey,e||f){if(g&&91!==g&&92!==g&&(d=b.contextMenu.actionCallbacks.byControl[g]))return a.preventDefault(),b.contextMenu.execute(d,a)}else switch(g){case 8:b.openCell||(a.preventDefault(),b["delete"]());break;case 9:return a.preventDefault(),b.moveTo(h?b.previousCell():b.nextCell());case 13:b.activeCell().onReturnKeyPress();break;case 16:break;case 32:b.openCell||(a.preventDefault(),b.activeCell().onSpaceKeyPress());break;case 37:b.moveTo(b.previousCell());break;case 38:b.moveTo(b.aboveCell());break;case 39:b.activeCell().isBeingEdited()||b.moveTo(b.nextCell());break;case 40:b.moveTo(b.belowCell());break;case 46:if(!b.openCell){a.preventDefault(),b["delete"]();break}break;default:return c.call([96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111],g)>=0&&(g-=48),b.openCellAndPopulateInitialValue(h,g)}},window.onresize=function(){return b.openCell?a.Utilities.prototype.setStyles(b.openCell.control,b.openCell.position()):void 0},window.onscroll=function(){return b.openCell?b.openCell.reposition():void 0},this.element.onscroll=function(){return b.openCell&&b.openCell.reposition(),b.useFixedHeaders?a.Utilities.prototype.repositionFixedHeader(b):void 0},this.tableEl.oncontextmenu=function(){return!1},document.oncontextmenu=function(a){return b.contextMenu.element===a.target?!1:!0},document.onclick=function(c){var d;return d=b.firstActiveCell(),b.isDescendant(c.target||b.contextMenu.isVisible())||c.target!==(null!=d?d.control:void 0)&&((null!=d?d.isBeingEdited():void 0)&&null!=d&&d.edit(null!=d?d.control.value:void 0),a.Utilities.prototype.clearActiveCells(b)),b.contextMenu.hide()}},a.prototype.render=function(){return this.element.hasChildNodes()&&(this.element=document.querySelectorAll(this.config.element||"#gridedit")[0]),this.element.appendChild(this.tableEl)},a.prototype.getCell=function(a,b){var c;try{return this.rows[a].cells[b]}catch(d){c=d}},a.prototype.set=function(a,b){return void 0!==a?this.config[a]=b:void 0},a.prototype.activeCell=function(){return this.activeCells.length>1?this.activeCells:this.activeCells[0]},a.prototype.firstActiveCell=function(){return this.activeCells[0]},a.prototype.nextCell=function(){var a;return null!=(a=this.firstActiveCell())?a.next():void 0},a.prototype.previousCell=function(){var a;return null!=(a=this.firstActiveCell())?a.previous():void 0},a.prototype.aboveCell=function(){var a;return null!=(a=this.firstActiveCell())?a.above():void 0},a.prototype.belowCell=function(){var a;return null!=(a=this.firstActiveCell())?a.below():void 0},a.prototype.moveTo=function(a,b){var c,d,e,f,g;return a&&(void 0===b&&(b=a.table.firstActiveCell()),d=a.table.getDirection(b,a),a.beforeNavigateTo&&(c=a.beforeNavigateTo(a,b,d)),c!==!1&&(a.isVisible()||(g=a.table.activeCell().address[0],f=a.address[0],e=1,g>f&&(e=-1),window.scrollBy(0,(null!=a?a.position().height:void 0)*e)),a.makeActive())),!1},a.prototype.getDirection=function(a,b){var c,d,e,f,g;return e=a.address[0],g=b.address[0],d=a.address[1],f=b.address[1],e===g?d>f?c="left":f>d?c="right":console.log("Cannot calculate direction going from cell "+a.address+" to cell "+b.address):e>g?c="up":g>e?c="down":console.log("Cannot calculate direction going from cell "+a.address+" to cell "+b.address),c},a.prototype.edit=function(a,b){return null==b&&(b=null),null!==b?null!=a?a.cellTypeObject.edit(b):void 0:(a.cellTypeObject.edit(),!1)},a.prototype["delete"]=function(){var a,b,c,d;for(d=this.activeCells,b=0,c=d.length;c>b;b++)a=d[b],a.editable&&a.value("");return!0},a.prototype.clearActiveCells=function(){return a.Utilities.prototype.clearActiveCells(this)},a.prototype.setSelection=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.selectionStart&&this.selectionEnd&&this.selectionStart!==this.selectionEnd){for(j=this.activeCells,d=0,e=j.length;e>d;d++)a=j[d],a.showInactive();for(this.activeCells=[],p=function(){m=[];for(var a=k=this.selectionStart.address[0],b=this.selectionEnd.address[0];b>=k?b>=a:a>=b;b>=k?a++:a--)m.push(a);return m}.apply(this),c=function(){n=[];for(var a=l=this.selectionStart.address[1],b=this.selectionEnd.address[1];b>=l?b>=a:a>=b;b>=l?a++:a--)n.push(a);return n}.apply(this),h=0,f=p.length;f>h;h++)for(o=p[h],i=0,g=c.length;g>i;i++)b=c[i],this.rows[o].cells[b].addToSelection()}},a.prototype.data=function(){var a,b,c,d,e,f,g,h,i,j;for(b=[],g=this.rows,c=0,e=g.length;e>c;c++){for(i=g[c],j=[],h=i.cells,d=0,f=h.length;f>d;d++)a=h[d],j.push(a.cellTypeObject.value());b.push(j)}return b},a.prototype.repopulate=function(){var a,b,c,d,e,f;for(d=this.rows,e=[],b=0,c=d.length;c>b;b++)f=d[b],e.push(function(){var b,c,d,e;for(d=f.cells,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.value(a.source[a.valueKey]));return e}());return e},a.prototype.destroy=function(){var a,b;this.useFixedHeaders&&this.fixedHeader&&this.fixedHeader.table&&this.fixedHeader.table.parentNode&&document.body.removeChild(this.fixedHeader.table),this.element.removeChild(this.tableEl),b=[];for(a in this)b.push(delete this[a]);return b},a.prototype.isDescendant=function(a){var b;for(b=a.parentNode;null!=b;){if(b===this.tableEl)return!0;b=b.parentNode}return!1},a.prototype.addToStack=function(a){return this.actionStack.addAction(a)},a.prototype.undo=function(){return this.actionStack.undo()},a.prototype.redo=function(){return this.actionStack.redo()},a.prototype.moveRow=function(b,c,d){var e;return null==d&&(d=!0),e=this.source[b],a.Hook.prototype.run(this,"beforeMoveRow",b,c)?(this.source.splice(b,1),this.source.splice(c,0,e),d&&this.addToStack({type:"move-row",oldIndex:b,newIndex:c}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[c,0]}),this.setDirtyRows(),a.Hook.prototype.run(this,"afterMoveRow",b,c)):void 0},a.prototype.moveRows=function(b,c,d,e){var f,g,h,i,j;if(null==e&&(e=!0),a.Hook.prototype.run(this,"beforeMoveRows",b,c)){if(g=b,h=c,f=b+d,c>b){if(f>c)return void this.clearActiveCells();c=c-d+1}else g=b+d-1;for(j=this.source.splice(b,d),i=j.pop();i;)this.source.splice(c,0,i),i=j.pop();return e&&this.addToStack({type:"move-rows",modifiedRowToMoveIndex:g,modifiedNewIndex:c,numRows:d,originalRowToMoveIndex:b,originalNewIndex:h}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[c,0]}),this.setDirtyRows(),a.Hook.prototype.run(this,"afterMoveRows",b,c,d)}},a.prototype.addRow=function(b,c,d){var e,f,g,h,i;if(null==c&&(c=!0),null==d&&(d=!1),a.Hook.prototype.run(this,"beforeAddRow",b,d)){if(d)i=d;else for(i={},h=this.cols,f=0,g=h.length;g>f;f++)e=h[f],i[e.valueKey]=e.defaultValue||"";return b||0===b?this.source.splice(b,0,i):(b=this.source.length-1,this.source.push(i)),c&&this.addToStack({type:"add-row",index:b,rowObject:d}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[b,0]}),this.setDirtyRows(),a.Hook.prototype.run(this,"afterAddRow",b,d)}},a.prototype.addRows=function(b,c,d){var e,f,g,h,i,j,k,l,m,n;if(null==c&&(c=!0),null==d&&(d=[]),a.Hook.prototype.run(this,"beforeAddRows",b,d)){for(f=g=0,i=d.length;i>g;f=++g){if(n=d[f],k=b+f,n)m=n;else for(m={},l=this.cols,h=0,j=l.length;j>h;h++)e=l[h],m[e.valueKey]=e.defaultValue||"";k||0===k?this.source.splice(k,0,m):(k=this.source.length-1,this.source.push(m))}return c&&this.addToStack({type:"add-rows",index:b,rowObjects:d}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[b,0]}),this.setDirtyRows(),a.Hook.prototype.run(this,"afterAddRows",b,d)}},a.prototype.addScatteredRows=function(a){var b,c,d,e,f;for(e=Object.keys(a),e=e.sort(),c=0,d=e.length;d>c;c++)b=e[c],f=a[b],this.source.splice(b,0,f);return this.rebuild({rows:this.source,initialize:!0,selectedCell:[b,0]}),this.setDirtyRows()},a.prototype.insertBelow=function(){var b;return b=this.contextMenu.getUpperLeftPasteCell(),a.Hook.prototype.run(this,"beforeInsertBelow",b)?(this.addRow(b.address[0]+1),this.setDirtyRows(),a.Hook.prototype.run(this,"afterInsertBelow",b)):void 0},a.prototype.insertAbove=function(){var b;return b=this.contextMenu.getUpperLeftPasteCell(),a.Hook.prototype.run(this,"beforeInsertAbove",b)?(this.addRow(b.address[0]),this.setDirtyRows(),a.Hook.prototype.run(this,"afterInsertAbove",b)):void 0},a.prototype.removeRow=function(b,c){var d,e,f;return null==c&&(c=!0),a.Hook.prototype.run(this,"beforeRemoveRow",b)?(e=this.source[b],d=this.rows[b],f=this.source.splice(b,1),c&&this.addToStack({type:"remove-row",index:b,rowObject:e}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[b,0]}),this.setDirtyRows(),a.Hook.prototype.run(this,"afterRemoveRow",b)):void 0},a.prototype.removeRows=function(b,c){var d,e,f,g,h;if(null==c&&(c=!0),a.Hook.prototype.run(this,"beforeRemoveRows",b)){for(b=b.sort(function(a,b){return b-a}),h={},e=0,f=b.length;f>e;e++)d=b[e],g=this.source[d],h[d]=g,this.source.splice(d,1);return c&&this.addToStack({type:"remove-rows",rowIndexes:b,rowObjects:h}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[d,0]}),this.setDirtyRows(),a.Hook.prototype.run(this,"afterRemoveRows",b)}},a.prototype.selectRow=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(this.activeCell()&&b){if(f=this.activeCells[0].address[0],q=b.shiftKey,e=b.ctrlKey,d=b.metaKey,e||d||a.Utilities.prototype.clearActiveCells(this),q){if(g=f-c,0>g){for(l=this.rows.slice(f,+c+1||9e9),n=[],h=0,j=l.length;j>h;h++)p=l[h],n.push(p.select());return n}for(m=this.rows.slice(c,+f+1||9e9),o=[],i=0,k=m.length;k>i;i++)p=m[i],o.push(p.select());return o}return p=this.rows[c],p.select()}return p=this.rows[c],p.select()},a.prototype.calculateSubtotals=function(){var a,b,c,d,e;for(c=this.subtotalRows,d=[],a=0,b=c.length;b>a;a++)e=c[a],d.push(e.calculate());return d},a.prototype.openCellAndPopulateInitialValue=function(b,c){return this.openCell?void 0:this.activeCell().onKeyPress(a.Utilities.prototype.valueFromKey(c,b))},a.prototype.checkIfCellIsDirty=function(a){var b;if(b=this.dirtyCells.indexOf(a),-1===b){if(a.isDirty())return this.dirtyCells.push(a)}else if(!a.isDirty())return this.dirtyCells.splice(b,1)},a.prototype.setDirtyRows=function(){var a,b,c,d,e;if(!this.config.uniqueValueKey)return!1;this.dirtyRows=[],e=this.uniqueValueKey,a=this.rowIndex,b=[];for(c in a)d=a[c],b.push(d!==this.source[c][e]?this.dirtyRows.push(c):void 0);return b},a.prototype.isDirty=function(){return this.dirtyRows.length>0||this.dirtyCells.length>0},a.prototype.addUndoAction=function(a,b){return this.actionStack.addUndo(a,b)},a.prototype.addRedoAction=function(a,b){return this.actionStack.addRedo(a,b)},a}(),b="undefined"!=typeof exports&&null!==exports?exports:window,b.GridEdit=a}).call(this),function(){GridEdit.ActionStack=function(){function a(a){this.table=a,this.userDefinedActions={undo:{},redo:{}},this.index=-1,this.actions=[]}return a.prototype.getCell=function(a){return this.table.getCell(a.address[0],a.address[1])},a.prototype.addAction=function(a){return this.actions.length>0&&this.index<this.actions.length-1&&(this.actions=this.actions.splice(0,this.index+1)),this.actions.push(a),this.index++},a.prototype.addUndo=function(a,b){return this.userDefinedActions.undo[a]=b},a.prototype.addRedo=function(a,b){return this.userDefinedActions.redo[a]=b},a.prototype.undo=function(){var a,b,c,d,e,f;if(this.index>-1)switch(this.index--,a=this.actions[this.index+1],a.type){case"cell-edit":b=this.getCell(a),b.value(a.oldValue,!1);break;case"cut":a.grid.undo(!1,!1);break;case"paste-pasteGrid":a.pasteGrid.undo(a.x,a.y);break;case"paste-copyGrid":a.grid.undo(a.x,a.y);break;case"fill":a.grid.undo(!1,!1);break;case"add-row":this.table.removeRow(a.index,!1);break;case"remove-row":this.table.addRow(a.index,!1,a.rowObject);break;case"move-row":this.table.moveRow(a.newIndex,a.oldIndex,!1);break;case"add-rows":for(f=[],c=d=0,e=a.rowObjects.length;e>=0?e>d:d>e;c=e>=0?++d:--d)f.push(c+a.index);this.table.removeRows(f,!1);break;case"remove-rows":this.table.addScatteredRows(a.rowObjects);break;case"move-rows":this.table.moveRows(a.modifiedNewIndex,a.modifiedRowToMoveIndex,a.numRows,!1);break;default:return this.userDefinedActions.undo[a.type](a)}},a.prototype.redo=function(){var a,b;if(this.index<this.actions.length-1)switch(this.index++,a=this.actions[this.index],a.type){case"cell-edit":b=this.table.getCell(a.address[0],a.address[1]),b.value(a.newValue,!1);break;case"cut":a.grid.apply(!1,!1);break;case"paste-pasteGrid":a.grid.applyTo(a.pasteGrid);break;case"paste-copyGrid":a.grid.apply(a.x,a.y);break;case"fill":a.grid.apply(!1,!1);break;case"add-row":this.table.addRow(a.index,!1,a.rowObject);break;case"remove-row":this.table.removeRow(a.index,!1);break;case"move-row":this.table.moveRow(a.oldIndex,a.newIndex,!1);break;case"add-rows":this.table.addRows(a.index,!1,a.rowObjects);break;case"remove-rows":this.table.removeRows(a.rowIndexes,!1);break;case"move-rows":this.table.moveRows(a.originalRowToMoveIndex,a.originalNewIndex,a.numRows,!1);break;default:return this.userDefinedActions.redo[a.type](a)}},a}()}.call(this),function(){GridEdit.ContextMenu=function(){function a(a){var b,c,d,e,f,g,h,i;if(this.table=a,this.active=this.table.config.includeContextMenu!==!1,this.userDefinedActions=this.table.config.contextMenuItems,this.userDefinedOrder=this.table.config.contextMenuOrder,d=/Mac/.test(navigator.platform)?"Cmd":"Ctrl",this.actionNodes={},this.actionCallbacks={byName:{},byControl:{}},this.borderedCells=[],this.defaultActions={cut:{name:"Cut",shortCut:d+"+X",callback:this.cut},copy:{name:"Copy",shortCut:d+"+C",callback:this.copy},paste:{name:"Paste",shortCut:d+"+V",callback:this.paste},undo:{name:"Undo",shortCut:d+"+Z",callback:this.undo},redo:{name:"Redo",shortCut:d+"+Y",callback:this.redo},fill:{name:"Fill",shortCut:"",hasDivider:!0,callback:this.fill},selectAll:{name:"Select All",shortCut:d+"+A",callback:this.selectAll},insertBelow:{name:"Insert Row Below",shortCut:"",callback:this.insertBelow},insertAbove:{name:"Insert Row Above",shortCut:"",callback:this.insertAbove},removeRow:{name:"Remove Row(s)",shortCut:"",callback:this.removeRow}},this.element=document.createElement("div"),this.element.id="gridedit-context-menu",this.element.style.position="fixed",this.element.style.zIndex="1040",this.menu=document.createElement("ul"),GridEdit.Utilities.prototype.setAttributes(this.menu,{"class":"dropdown-menu",role:"menu","aria-labelledby":"aria-labelledby",style:"display:block;position:static;margin-bottom:5px;"}),this.active)if(this.userDefinedOrder)for(g=this.userDefinedOrder,e=0,f=g.length;f>e;e++)c=g[e],b=this.userDefinedActions?this.userDefinedActions[c]||this.defaultActions[c]:this.defaultActions[c],b&&this.addAction(b);else{h=this.defaultActions;for(c in h)b=h[c],(!this.userDefinedActions||!this.userDefinedActions[c]&&this.userDefinedActions[c]!==!1)&&this.addAction(b);i=this.userDefinedActions;for(c in i)b=i[c],this.userDefinedActions[c]!==!1&&this.addAction(b)}this.element.appendChild(this.menu),this.events(this),GridEdit.Hook.prototype.initContextMenuHooks(this)}return a.prototype.addDivider=function(){var a;return a=document.createElement("li"),GridEdit.Utilities.prototype.setAttributes(a,{"class":"divider"}),this.menu.appendChild(a)},a.prototype.addAction=function(a){var b,c,d,e,f,g,h;return f=document.createElement("li"),f.setAttribute("name",a.name),d=document.createElement("div"),h=document.createElement("span"),h.textContent=a.shortCut,GridEdit.Utilities.prototype.setAttributes(h,{style:"float: right !important;"}),b=document.createElement("a"),b.textContent=a.name,b.setAttribute("name",a.name),GridEdit.Utilities.prototype.setAttributes(b,{"class":"enabled",tabIndex:"-1"}),a.hasDivider&&this.addDivider(),b.appendChild(h),f.appendChild(b),this.actionNodes[a.name]=f,this.actionCallbacks.byName[a.name]=a.callback,g=a.shortCut,g&&/(ctrl|cmd)/i.test(g)&&(e=g.split("+")[1],c=e.charCodeAt(0),this.actionCallbacks.byControl[c]=a.callback),this.menu.appendChild(f)},a.prototype.show=function(a,b,c){var d;return this.cell=c,this.active?(this.cell.isActive()||this.cell.makeActive(),this.cells=this.cell.table.activeCells,GridEdit.Utilities.prototype.setStyles(this.element,{left:a,top:b}),document.body.appendChild(this.element),d=this.element,setTimeout(function(){var a,b,c,e,f,g,h,i,j,k,l,m;return j=d.getBoundingClientRect(),l=GridEdit.Utilities.prototype.getScreenDimensions(),h=l.height>j.height,b=j.bottom>l.height,f=j.top<0,g=l.width>j.width,e=j.right>l.width,c=j.left<0,h?(d.style.overflowY="hidden",d.style.height="auto",b&&(m=j.top-(j.bottom-l.height),d.style.top=m+"px"),f&&(a=j.bottom+Math.abs(j.top),d.style.bottom=a+"px")):(d.style.top=0,d.style.height=l.height+"px",d.style.overflowY="scroll"),g?(d.style.overflowX="hidden",d.style.width="auto",e&&(i=j.left-(j.right-l.width),d.style.left=i+"px"),c?(k=j.right+Math.abs(j.left),d.style.right=k+"px"):void 0):(d.style.left=0,d.style.width=l.width+"px",d.style.overflowX="scroll")},100),!1):void 0},a.prototype.hide=function(){return this.isVisible()?document.body.removeChild(this.element):void 0},a.prototype.isVisible=function(){return null!=this.element.parentNode},a.prototype.getTargetPasteCell=function(){return this.table.activeCells.sort(this.sortFunc)[0]},a.prototype.sortFunc=function(a,b){return a.address[0]-b.address[0]},a.prototype.getUpperLeftPasteCell=function(){var a,b,c,d,e,f,g;for(b=this.table.activeCells,f=b[0],d=0,e=b.length;e>d;d++)a=b[d],g=a.address[0],c=a.address[1],g<f.address[0]?f=a:g===f.address[0]&&c<f.address[1]&&(f=a);return f},a.prototype.displayBorders=function(){return this.table.copiedGridChange?this.table.copiedGridChange.displayBorders():void 0},a.prototype.hideBorders=function(){return this.table.copiedGridChange?this.table.copiedGridChange.removeBorders():void 0},a.prototype.cut=function(a,b){var c,d;return d=b.contextMenu,d.hideBorders(),b.copiedGridChange=new GridEdit.GridChange(b.activeCells),c=new GridEdit.GridChange(b.activeCells,"ge-blank"),c.apply(!1,!1),b.addToStack({type:"cut",grid:c}),d.displayBorders(),d.hide()},a.prototype.copy=function(a,b){var c;return c=b.contextMenu,b.copiedGridChange=new GridEdit.GridChange(b.activeCells),c.displayBorders(),c.hide()},a.prototype.paste=function(a,b){var c,d,e,f,g,h,i;return f=b.contextMenu,f.hide(),c=f.getUpperLeftPasteCell(),d=b.copiedGridChange,c.editable&&d?(g=new GridEdit.GridChange(b.activeCells),g.copyValues(),e=d.applyTo(g),h=c.address[0],i=c.address[1],b.addToStack("pasteGrid"===e?{type:"paste-pasteGrid",grid:d,pasteGrid:g,x:h,y:i}:{type:"paste-copyGrid",grid:d,x:h,y:i})):void 0},a.prototype.fill=function(a,b){var c,d,e,f;return f=b.contextMenu,c=f.getUpperLeftPasteCell(),d=c.value(),e=new GridEdit.GridChange(b.activeCells,d),e.apply(!1,!1),b.addToStack({type:"fill",grid:e}),f.hide()},a.prototype.selectAll=function(a,b){return b.clearActiveCells(),setTimeout(function(){var a,c,d,e,f;for(d=b.rows,e=[],a=0,c=d.length;c>a;a++)f=d[a],e.push(f.select());return e},100)},a.prototype.insertBelow=function(a,b){return b.insertBelow()},a.prototype.insertAbove=function(a,b){return b.insertAbove()},a.prototype.removeRow=function(a,b){var c,d,e,f,g,h;for(d=new GridEdit.GridChange(b.activeCells),h={},g=d.cells,e=0,f=g.length;f>e;e++)c=g[e],h[c.address[0]]=!0;return b.removeRows(Object.keys(h))},a.prototype.undo=function(a,b){return b.undo()},a.prototype.redo=function(a,b){return b.redo()},a.prototype.toggle=function(a){var b;return b=this.actionNodes[a].classList,b.toggle("enabled"),b.toggle("disabled")},a.prototype.execute=function(a,b){var c;return this.table.openCell&&this.table.openCell.hideControl(),GridEdit.Hook.prototype.run(this,"beforeContextMenuAction",b,this.table)?(a(b,this.table),c=this.table,setTimeout(function(){return c.useFixedHeaders?GridEdit.Utilities.prototype.fixHeaders(c):void 0},100),GridEdit.Hook.prototype.run(this,"afterContextMenuAction",b,this.table)):void 0},a.prototype.events=function(a){return this.element.onclick=function(b){var c;return c=b.target.getAttribute("name"),a.execute(a.actionCallbacks.byName[c],b)}},a}()}.call(this),function(){GridEdit.Utilities=function(){function a(){}return a.prototype.setAttributes=function(a,b){var c,d,e;d=[];for(c in b)e=b[c],d.push(e?a.setAttribute(c,e):void 0);return d},a.prototype.setStyles=function(a,b){var c,d,e;d=[];for(c in b)e=b[c],d.push(a.style[c]=e+"px");return d},a.prototype.clearActiveCells=function(a){var b,c,d,e,f,g,h,i,j;if(j=a.redCells,c=a.activeCells,a.openCell&&a.openCell.edit(a.openCell.control.value),j.length>0){for(e=d=0,g=j.length;g>d;e=++d)i=j[e],null!=i&&i.makeInactive();a.redCells=[]}if(c.length>0){for(e=f=0,h=c.length;h>f;e=++f)b=c[e],null!=b&&b.makeInactive(),null!=b&&b.hideControl();a.activeCells=[]}return a.selectionStart=null,a.selectionEnd=null,a.contextMenu.hide(),a.selectedCol?a.selectedCol.makeInactive():void 0},a.prototype.capitalize=function(a){return a.toLowerCase().replace(/\b./g,function(a){return a.toUpperCase()})},a.prototype.valueFromKey=function(a,b){var c;return c=String.fromCharCode(a),b?c:c.toLowerCase()},a.prototype.getScreenDimensions=function(){var a,b,c,d,e,f;return d=window,a=document,b=a.documentElement,c=a.getElementsByTagName("body")[0],e=d.innerWidth||b.clientWidth||c.clientWidth,f=d.innerHeight||b.clientHeight||c.clientHeight,{width:e,height:f}},a.prototype.repositionFixedHeader=function(a){var b,c,d,e,f,g;return f=a.fixedHeader,f&&(e=f.table)?(d=document.documentElement,g=(window.pageXOffset||d.scrollLeft)-(d.clientLeft||0),b=a.thead,c=b.getBoundingClientRect(),e.style.left=c.left+g+"px"):void 0},a.prototype.fixHeaders=function(a){return clearTimeout(this.fixHeadersBuffer),this.fixHeadersBuffer=setTimeout(function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;for(s=a.config.includeRowHandles?1:0,d=a.thead,h=d.getElementsByTagName("th"),a.fixedHeader?(A=a.fixedHeader.table,A&&A.parentNode&&a.fixedHeader.table.parentNode.removeChild(A),b=a.fixedHeader.backgroundColor):(b=window.getComputedStyle(d).backgroundColor,("rgba(0, 0, 0, 0)"===b||"transparent"===b)&&(b="white")),i=document.documentElement,w=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),x=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),n=a.element,o=n.scrollLeft||0,p=n.scrollTop||0,e=d.getBoundingClientRect(),m=document.createElement("table"),m.className=a.tableEl.className+" ge-fixed-table-header",m.style.position="absolute",m.style.top=e.top+x+p+"px",m.style.left=e.left+w+o+"px",m.style.width=e.width+"px",m.style.zIndex=1039,m.style.pointerEvents="none",k=document.createElement("thead"),k.className=d.className,k.ondragenter=d.ondragenter,k.ondragleave=d.ondragleave,l=document.createElement("tr"),u=0,r=q=0,v=h.length;v>q;r=++q){if(f=h[r],g=f.getBoundingClientRect(),j=document.createElement("th"),j.innerHTML=f.innerHTML,j.className=f.className,j.style.position="absolute",j.style.minWidth=g.width+"px",j.style.maxWidth=g.width+"px",j.style.minHeight=g.height+"px",j.style.maxHeight=g.height+"px",j.style.left=u+"px",j.style.backgroundColor=b,j.setAttribute("col-id",r-s),j.onclick=function(){var b,c;return c=this.getAttribute("col-id"),b=a.cols[c],GridEdit.Utilities.prototype.clearActiveCells(a),setTimeout(function(){var a,c,d,e,f;for(b.makeActive(),e=b.cells,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(a.addToSelection());return f},0)},c=a.cols[r-s])if(c.headerStyle){y=c.headerStyle;for(t in y)B=y[t],j.style[t]=B}else{z=c.style;for(t in z)B=z[t],j.style[t]=B}u+=g.width,l.appendChild(j)}return k.appendChild(l),m.appendChild(k),document.body.appendChild(m),a.fixedHeader={table:m,backgroundColor:b}},100)},a}()}.call(this),function(){GridEdit.Column=function(){function a(a,b){var c,d,e,f;this.attributes=a,this.table=b,this.id=this.index=this.table.cols.length,this.defaultValue=this.attributes.defaultValue,this.cellClass=this.attributes.cellClass,this.cells=[],this.element=document.createElement("th"),this.textNode=document.createTextNode(this.attributes.label),this.element.appendChild(this.textNode),c=this.attributes.format,this.format=function(a){return c?c(a):a},e=this.attributes;for(d in e)f=e[d],this[d]=f;delete this.attributes,this.applyStyle(),this.events()}return a.prototype.applyStyle=function(){var a,b,c;if(this.headerStyle){a=[];for(c in this.headerStyle)a.push(this.element.style[c]=this.headerStyle[c]);return a}b=[];for(c in this.style)b.push(this.element.style[c]=this.style[c]);return b},a.prototype.next=function(){return this.table.cols[this.index+1]},a.prototype.previous=function(){return this.table.cols[this.index-1]},a.prototype.makeActive=function(){return this.element.classList.add("active"),this.table.selectedCol=this},a.prototype.makeInactive=function(){return this.element.classList.remove("active"),this.table.selectedCol=null},a.prototype.events=function(){var a,b;return a=this,b=a.table,this.element.onclick=function(){var c,d,e,f,g;for(GridEdit.Utilities.prototype.clearActiveCells(b),a.makeActive(),f=a.cells,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.addToSelection());return g},this.element.onmousedown=function(c){return 3===c.which?void b.contextMenu.show(c.x,c.y,a.cells[0]):!1}},a}()}.call(this),function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;GridEdit.Row=function(){function a(a,b){var c,d;this.attributes=a,this.table=b,this.id=this.table.rows.length,this.cells=[],this.index=this.table.rows.length,this.element=document.createElement("tr"),this.cssClass=this.attributes.cssClass,this.cssClass&&(this.element.className=this.cssClass),this.oldBorderBottom=this.element.style.borderBottom,this.oldBorderTop=this.element.style.borderTop,this.type=this.attributes.gridEditRowType,this.alwaysPristine=!1,d=this.table,c=this,this.element.ondragenter=function(){var a;return d.lastDragOverIsBeforeFirstRow=!1,a=d.lastDragOver,a?0!==c.index&&a.index===c.index||(a.element.style.borderBottom=c.oldBorderBottom,c.element.style.borderBottom=d.theme.borders.dragBorderStyle):c.element.style.borderBottom=d.theme.borders.dragBorderStyle,d.lastDragOver=c},this.includeRowHandles=this.table.config.includeRowHandles,GridEdit.Utilities.prototype.setAttributes(this.element,{id:"row-"+this.id})}return a.prototype.createCell=function(a){var b,c,d,e;switch(d=this.cells.length,c=this.table.cols[d],e=c.type){case"string":b=new GridEdit.StringCell(a,this);break;case"number":b=new GridEdit.NumberCell(a,this);break;case"date":b=new GridEdit.DateCell(a,this);break;case"html":b=new GridEdit.HTMLCell(a,this);break;case"select":b=new GridEdit.SelectCell(a,this);break;case"textarea":b=new GridEdit.TextAreaCell(a,this);break;case"checkbox":b=new GridEdit.CheckBoxCell(a,this);break;default:b=new GridEdit.GenericCell(a,this)}return b},a.prototype.below=function(){return this.table.rows[this.index+1]},a.prototype.above=function(){return this.table.rows[this.index-1]},a.prototype.select=function(){var a,b,c,d,e;for(d=this.cells,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.addToSelection());return e},a.prototype.afterEdit=function(){return this.table.calculateSubtotals()},a.prototype.addHandle=function(){var a;return this.includeRowHandles?(a=new GridEdit.HandleCell(this),this.element.appendChild(a.element)):void 0},a}(),GridEdit.GenericRow=function(b){function c(a,b){var d,e,f,g,h,i;for(this.attributes=a,this.table=b,c.__super__.constructor.apply(this,arguments),this.editable=!0,this.addHandle(),i=this.table.cols,f=g=0,h=i.length;h>g;f=++g)e=i[f],d=this.createCell(this.attributes[e.valueKey]),this.cells.push(d),this.table.cols[f].cells.push(d),this.element.appendChild(d.element);delete this.attributes}return a(c,b),c}(GridEdit.Row),GridEdit.StaticRow=function(b){function c(a,b){this.attributes=a,this.table=b,c.__super__.constructor.apply(this,arguments),this.addHandle(),this.editable=this.attributes.editable=!1,this.element.innerHTML=this.attributes.html,
this.type="static",delete this.attributes}return a(c,b),c}(GridEdit.Row),GridEdit.SubTotalRow=function(b){function c(a,b){var d,e,f,g,h,i,j;for(this.attributes=a,this.table=b,c.__super__.constructor.apply(this,arguments),this.subtotalColumns={},this.labels=this.attributes.labels,this.running=this.attributes.running,this.alwaysPristine=!0,this.addHandle(),i=this.table.cols,f=g=0,h=i.length;h>g;f=++g)e=i[f],d=new GridEdit.GenericCell("",this),d.editable=!1,this.labels&&(j=this.labels[e.valueKey],d.element.innerHTML=j||""),this.cells.push(d),this.table.cols[f].cells.push(d),this.element.appendChild(d.element),this.attributes.subtotal[e.valueKey]&&(this.subtotalColumns[e.valueKey]=f);this.table.subtotalRows.push(this),this.calculate()}return a(c,b),c.prototype.calculate=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(n=-1,!this.running)for(h=this.table.subtotalRows,d=0,f=h.length;f>d;d++)o=h[d],m=o.index,m<this.index&&m>n&&(n=m);i=this.subtotalColumns,k=[];for(b in i){for(c=i[b],p=0,j=this.table.rows,e=0,g=j.length;g>e;e++)if(l=j[e],l.index>n){if(l.index===this.index)break;"subtotal"!==l.type&&"header"!==l.type&&(a=l.cells[c],a&&(p+=Number(a.value())))}k.push(this.cells[c].value(p,!1))}return k},c.prototype.afterEdit=function(){},c}(GridEdit.Row),GridEdit.HeaderRow=function(b){function c(a,b){var d,e,f,g,h,i;for(this.attributes=a,this.table=b,c.__super__.constructor.apply(this,arguments),this.editable=!0,this.addHandle(),i=this.table.cols,f=g=0,h=i.length;h>g;f=++g)e=i[f],d=new GridEdit.HTMLCell(this.attributes[e.valueKey],this),d.editable=!0,this.cells.push(d),this.table.cols[f].cells.push(d),this.element.appendChild(d.element);delete this.attributes}return a(c,b),c}(GridEdit.Row)}.call(this),function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;GridEdit.Cell=function(){function a(a,b){this.originalValue=a,this.row=b,this.index=this.row.cells.length,this.id=this.row.id+"-"+this.index,this.address=[this.row.id,this.index],this.table=this.row.table,this.col=this.table.cols[this.index],this.meta=this.col,this.element=document.createElement("td")}return a.prototype.initialize=function(){return this.initEditable(),this.initValueKey(),this.initSource(),this.initOriginalValue(),this.initSourceValue(),this.initNode(),this.initControl(),this.applyControlBehavior(),this.applyEventBehavior(),GridEdit.Hook.prototype.initCellHooks(this),this.applyStyle()},a.prototype.initOriginalValue=function(){return void 0===this.originalValue?this.originalValue="":void 0},a.prototype.initSourceValue=function(){return this.source[this.valueKey]=this.originalValue},a.prototype.initEditable=function(){return this.editable=this.col.editable!==!1},a.prototype.initValueKey=function(){return this.valueKey=this.col.valueKey},a.prototype.initSource=function(){return this.source=this.table.config.rows[this.address[0]]},a.prototype.initControl=function(){return this.control=document.createElement("input")},a.prototype.initNode=function(){return this.element.appendChild(document.createTextNode(this.col.format(this.originalValue))),!this.placeholder&&!this.col.placeholder||this.originalValue?void 0:this.renderPlaceholder()},a.prototype.renderPlaceholder=function(){return this.originalColor=this.element.style.color,this.element.style.color="#ccc",this.element.textContent=this.placeholder||this.col.placeholder},a.prototype.showRed=function(){return this.showUneditable()},a.prototype.applyStyle=function(){var a,b;if(this.col.cellClass&&this.element.classList.add(this.col.cellClass),this.col.style){a=[];for(b in this.col.style)a.push(this.element.style[b]=this.col.style[b]);return a}},a.prototype.addToSelection=function(){return this.showActive(),this.table.activeCells.push(this)},a.prototype.removeFromSelection=function(){var a;return a=this.table.activeCells.indexOf(this),this.table.activeCells.splice(a,1),this.showInactive()},a.prototype.isActive=function(){return-1!==this.table.activeCells.indexOf(this)},a.prototype.makeActive=function(a){var b;return null==a&&(a=!0),this.table.hideControl(),a&&GridEdit.Utilities.prototype.clearActiveCells(this.table),!this.isActive()&&GridEdit.Hook.prototype.run(this,"beforeActivate",this)?(this.showActive(),this.table.activeCells.push(this),this.table.selectionStart=this,b=this.table.openCell,b&&b.edit(b.control.value),GridEdit.Hook.prototype.run(this,"afterActivate",this)):void 0},a.prototype.makeInactive=function(){return this.showInactive()},a.prototype.showActive=function(){return this.isActive()?void 0:(this.oldBackgroundColor=this.element.style.backgroundColor,this.element.style.backgroundColor=this.table.theme.cells.activeColor)},a.prototype.showInactive=function(){return this.element.style.backgroundColor=this.oldBackgroundColor||""},a.prototype.showUneditable=function(){var a;return this.element.style.backgroundColor=this.table.theme.cells.uneditableColor,this.table.mobile?(a=this,setTimeout(function(){return a.makeInactive()},1e3)):this.table.redCells.push(this)},a.prototype.edit=function(a){return null==a&&(a=null),this.editable?null===a?this.showControl():(this.value(a),this.isBeingEdited()?this.hideControl():void 0):this.showUneditable()},a.prototype.value=function(a,b){var c,d;return null==a&&(a=null),null==b&&(b=!0),c=this.source[this.valueKey],null!==a&&a!==c?(a=this.formatValue(a),d=this.value(),GridEdit.Hook.prototype.run(this,"beforeEdit",this,d,a)?(b&&this.table.addToStack({type:"cell-edit",oldValue:d,newValue:a,address:this.address}),this.setValue(a),this.renderValue(a),this.row.afterEdit(),this.table.useFixedHeaders&&GridEdit.Utilities.prototype.fixHeaders(this.table),GridEdit.Hook.prototype.run(this,"afterEdit",this,d,a,this.table.contextMenu.getUpperLeftPasteCell()),this.table.checkIfCellIsDirty(this),a):c):c},a.prototype.formatValue=function(a){return a},a.prototype.setValue=function(a){return this.source[this.valueKey]=a},a.prototype.select=function(){return this.control.select()},a.prototype.renderValue=function(a){return(this.placeholder||this.col.placeholder)&&""===a?this.renderPlaceholder():(this.element.style.color=this.originalColor||"",this.element.textContent=this.col.format(a))},a.prototype.isDirty=function(){return this.row.alwaysPristine?!1:this.originalValue!==this.value()},a.prototype.focus=function(){var a;return this.table.mobile?this.control.focus():(a=this.control,setTimeout(function(){var b,c;return a.focus(),b=0,a.value&&(b=a.value.length),a.setSelectionRange?a.setSelectionRange(b,b):a.createTextRange?(c=a.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()):void 0},0))},a.prototype.showControl=function(a){return null==a&&(a=null),this.editable?GridEdit.Hook.prototype.run(this,"beforeControlInit",this)?(this.table.contextMenu.hideBorders(),this.renderControl(),this.setControlValue(a),this.table.openCell=this,this.focus(),GridEdit.Hook.prototype.run(this,"afterControlInit",this)):void 0:this.showUneditable()},a.prototype.setControlValue=function(a){return this.control.value=a},a.prototype.renderControl=function(){return GridEdit.Utilities.prototype.setStyles(this.control,this.position()),this.table.element.appendChild(this.control),this.control.style.position="absolute"},a.prototype.hideControl=function(){return GridEdit.Hook.prototype.run(this,"beforeControlHide",this)?(this.isBeingEdited()&&this.control.parentNode.removeChild(this.control),this.table.openCell=null,GridEdit.Hook.prototype.run(this,"afterControlHide",this)):void 0},a.prototype.applyControlBehavior=function(){var a,b;return a=this,b=this.table,this.control.onkeydown=function(c){var d;switch(d=c.which){case 13:return a.edit(this.value);case 9:return a.edit(this.value),moveTo(b.nextCell())}}},a.prototype.position=function(){var a;return a=this.element.getBoundingClientRect(),{top:this.element.offsetTop,bottom:this.element.offsetTop+a.height,left:this.element.offsetLeft,right:this.element.offsetLeft+a.width,width:a.width,height:a.height}},a.prototype.reposition=function(){return this.table.mobile?void 0:GridEdit.Utilities.prototype.setStyles(this.control,this.position())},a.prototype.next=function(){var a;return this.row.cells[this.index+1]||(null!=(a=this.row.below())?a.cells[0]:void 0)},a.prototype.previous=function(){var a;return this.row.cells[this.index-1]||(null!=(a=this.row.above())?a.cells[this.row.cells.length-1]:void 0)},a.prototype.above=function(){var a;return null!=(a=this.row.above())?a.cells[this.index]:void 0},a.prototype.below=function(){var a;return null!=(a=this.row.below())?a.cells[this.index]:void 0},a.prototype.isBefore=function(a){return a.address[0]===this.address[0]&&a.address[1]>this.address[1]},a.prototype.isAfter=function(a){return a.address[0]===this.address[0]&&a.address[1]<this.address[1]},a.prototype.isAbove=function(a){return a.address[0]>this.address[0]&&a.address[1]===this.address[1]},a.prototype.isBelow=function(a){return a.address[0]<this.address[0]&&a.address[1]===this.address[1]},a.prototype.addClass=function(a){return this.element.classList.add(a)},a.prototype.removeClass=function(a){return this.element.classList.remove(a)},a.prototype.isBeingEdited=function(){return this.control?null!=this.control.parentNode:!1},a.prototype.toggleActive=function(){return this.isActive()?this.removeFromSelection():this.makeActive(!1)},a.prototype.isVisible=function(){var a;return a=this.position(),a.top>=this.table.topOffset&&a.bottom<=window.innerHeight},a.prototype.onReturnKeyPress=function(){return this.table.moveTo(this.table.belowCell())},a.prototype.onSpaceKeyPress=function(){return this.edit()},a.prototype.onKeyPress=function(a){return this.showControl(a)},a.prototype.applyEventBehavior=function(){var a,b,c,d;return a=this,d=this.table,b=null,this.element.onfocus=function(){return a.reposition()},d.mobile?(c=null,this.element.ontouchstart=function(a){return c=a.changedTouches[0].clientY,GridEdit.Utilities.prototype.clearActiveCells(d),d.openCell?d.openCell.hideControl():void 0},this.element.ontouchend=function(b){var d;return d=b.changedTouches[0].clientY,b.changedTouches.length<2&&d===c?(b.preventDefault(),a.edit()):void 0}):(this.element.onclick=function(c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(d.contextMenu.hideBorders(),d.lastClickCell===a)GridEdit.Hook.prototype.run(a,"onDblClick",a,c)&&(d.lastClickCell=null,a.showControl(a.value()));else if(d.lastClickCell=a,clearInterval(b),b=setTimeout(function(){return d.lastClickCell=null},1e3),GridEdit.Hook.prototype.run(a,"onClick",a,c)){if(n=c.ctrlKey,l=c.metaKey,B=c.shiftKey,e=function(){},j>=h)for(m=o=s=h,t=j;t>=s?t>=o:o>=t;m=t>=s?++o:--o)f=d.getCell(A,m),f.makeActive(!1);else for(m=p=u=j,v=h;v>=u?v>=p:p>=v;m=v>=u?++p:--p)f=d.getCell(A,m),f.makeActive(!1);if((n||l)&&a.toggleActive(),B)if(g=d.activeCells[0],i=g.address[0],h=g.address[1],k=a.address[0],j=a.address[1],k>=i)for(A=q=w=i,x=k;x>=w?x>=q:q>=x;A=x>=w?++q:--q)e(A);else for(A=r=y=k,z=i;z>=y?z>=r:r>=z;A=z>=y?++r:--r)e(A)}return!1},this.element.onmousedown=function(b){return 3===b.which?void d.contextMenu.show(b.x,b.y,a):(b.shiftKey||b.ctrlKey||b.metaKey||(d.state="selecting",a.makeActive()),!1)},this.element.onmouseover=function(){return"selecting"===d.state?(d.selectionEnd=a,d.setSelection()):void 0},this.element.onmouseup=function(b){return 3===b.which||(d.selectionEnd=a,d.state="ready",b.metaKey||b.ctrlKey)?void 0:d.setSelection()})},a}(),GridEdit.StringCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="string",this.initialize()}return a(c,b),c}(GridEdit.Cell),GridEdit.NumberCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="number",this.initialize()}return a(c,b),c.prototype.focus=function(){var a;return this.table.mobile?this.control.focus():(a=this.control,setTimeout(function(){return a.focus()},0))},c.prototype.initControl=function(){return this.control=document.createElement("input"),this.control.type="number"},c.prototype.normalizeValue=function(a){var b;return null===a||void 0===a||""===a?null:(b=Number(a),isNaN(b)?null:b)},c.prototype.formatValue=function(a){return this.normalizeValue(a)},c.prototype.setValue=function(a){return this.source[this.valueKey]=this.normalizeValue(a)},c}(GridEdit.Cell),GridEdit.CheckBoxCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="checkbox",this.initialize()}return a(c,b),c.prototype.initialize=function(){return this.initEditable(),this.initValueKey(),this.initSource(),this.initOriginalValue(),this.initSourceValue(),this.applyEventBehavior(),GridEdit.Hook.prototype.initCellHooks(this),this.applyStyle(),this.initNode(),this.toggleable=this.editable,this.editable=!1,this.renderValue()},c.prototype.initNode=function(){var a;return a=document.createElement("div"),a.style.width="1em",a.style.margin="auto",this.span=document.createElement("span"),a.appendChild(this.span),this.element.appendChild(a)},c.prototype.edit=function(){return!1},c.prototype.initControl=function(){return this.toggle()},c.prototype.renderControl=function(){return GridEdit.Utilities.prototype.clearActiveCells(this.table)},c.prototype.isBeingEdited=function(){return!1},c.prototype.toggle=function(){return this.toggleable?(this.value(!this.value()),this.setValue(this.value())):this.showUneditable()},c.prototype.renderValue=function(){var a;return a=this.toggleable?"":"disabled",this.value()?this.table.theme.inputs.checkbox.checkedClassName?this.span.className=this.table.theme.inputs.checkbox.checkedClassName:this.span.innerHTML="<input type='checkbox' "+a+" checked />":this.table.theme.inputs.checkbox.uncheckedClassName?this.span.className=this.table.theme.inputs.checkbox.uncheckedClassName:this.span.innerHTML="<input type='checkbox' "+a+" />"},c.prototype.applyEventBehavior=function(){var a;return c.__super__.applyEventBehavior.apply(this,arguments),a=this,this.element.onclick=function(){return a.table.contextMenu.hideBorders(),a.toggle()}},c.prototype.onSpaceKeyPress=function(){return this.toggle()},c}(GridEdit.Cell),GridEdit.DateCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="date",this.initialize()}return a(c,b),c.prototype.initNode=function(){return this.element.appendChild(document.createTextNode(this.toDateString(this.originalValue)))},c.prototype.initControl=function(){var a;this.control=this.toDate();try{if(this.originalValue)return this.control.valueAsDate=new Date(this.originalValue)}catch(b){return a=b,this.control.value=this.toDateString(new Date(this.originalValue))}},c.prototype.formatValue=function(a){var b;if(a.length>0)return this.toDateString(Date.parse(a));if(a instanceof Date)return this.toDateString(a);if(0===a.length){try{this.control.valueAsDate=null}catch(c){b=c,this.control.value=""}return""}},c.prototype.setValue=function(a){return this.source[this.valueKey]=this.toDateObject(a),this.setControlValue()},c.prototype.setControlValue=function(){var a;try{return this.control.valueAsDate=this.source[this.valueKey]}catch(b){return a=b,this.control.value=this.source[this.valueKey]}},c.prototype.renderValue=function(){return this.element.textContent=this.col.format(this.toDateString(this.value()))},c.prototype.toDateObject=function(a){var b;return null==a&&(a=null),a&&""!==a?(b=a.split("-"),new Date(b[2],b[0]-1,b[1])):null},c.prototype.toDateString=function(a){var b;return null==a&&(a=null),b=a&&""!==a?new Date(a):this.value()?new Date(this.value()):null,b instanceof Date?isNaN(b.getTime())?"":("0"+(b.getUTCMonth()+1)).slice(-2)+"-"+("0"+b.getUTCDate()).slice(-2)+"-"+b.getUTCFullYear():""},c.prototype.toDate=function(){var a;return a=document.createElement("input"),a.type="text",a.value=this.toDateString(),a},c.prototype.toDateInputString=function(a){var b;return null==a&&(a=null),a&&""!==a?b=new Date(a):this.value()&&(b=new Date(this.value())),b instanceof Date?b.getUTCFullYear()+"-"+("0"+(b.getUTCMonth()+1)).slice(-2)+"-"+("0"+b.getUTCDate()).slice(-2):""},c}(GridEdit.Cell),GridEdit.HTMLCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="html",this.initialize()}return a(c,b),c.prototype.initNode=function(){return this.htmlContent=this.col.defaultValue||this.originalValue||"",this.element.appendChild(this.toFragment())},c.prototype.setValue=function(a){var b;return this.htmlContent=a,b=this.toFragment(),this.element.innerHTML="",this.element.appendChild(b)},c.prototype.toFragment=function(){var a,b;return a=document.createElement("div"),b=document.createDocumentFragment(),a.innerHTML=this.htmlContent,b.appendChild(a.firstChild||document.createTextNode("")),b},c.prototype.renderValue=function(){return this.htmlContent},c}(GridEdit.Cell),GridEdit.SelectCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="select",this.initialize()}return a(c,b),c.prototype.initNode=function(){var a;return a=document.createTextNode(this.originalValue),this.element.appendChild(a)},c.prototype.setControlValue=function(){var a,b,c,d,e,f,g,h,i,j,k;for(a=this,this.control.innerHTML="",i=this.meta.choices,j=[],d=0,f=i.length;f>d;d++){if(b=i[d],h=document.createElement("option"),b instanceof Array)for(c=e=0,g=b.length;g>e;c=++e)k=b[c],0===c&&(h.value=k),1===c&&(h.text=k);else h.value=h.text=b;a.value()===b&&(h.selected=!0),j.push(this.control.add(h))}return j},c.prototype.initControl=function(){var a,b;return a=this,b=document.createElement("select"),this.control=b,this.meta.choices||console.log("There is not a 'choices' key in cell "+this.address+" and you specified that it was of type 'select'"),this.setControlValue(),b.classList.add(this.table.theme.inputs.select.className),b.onchange=function(b){return a.edit(b.target.value)}},c.prototype.select=function(){return!1},c.prototype.onSpaceKeyPress=function(){var a;return this.renderControl(),a=this.control,setTimeout(function(){var b;return b=document.createEvent("MouseEvents"),b.initMouseEvent("mousedown",!0,!0,window),a.dispatchEvent(b)},0)},c.prototype.onKeyPress=function(a){var b,c,d,e,f,g,h,i;for(this.onSpaceKeyPress(),i=new RegExp("^"+a,"i"),b=this.control,g=b.options,h=[],c=d=0,e=g.length;e>d;c=++d){if(f=g[c],i.test(f.value)){b.selectedIndex=c;break}h.push(void 0)}return h},c}(GridEdit.Cell),GridEdit.TextAreaCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="textarea",this.initialize()}return a(c,b),c.prototype.initControl=function(){var a,b;return a=this,b=document.createElement("textarea"),b.classList.add(this.table.theme.inputs.textarea.className),this.control=b},c}(GridEdit.Cell),GridEdit.GenericCell=function(b){function c(a,b){this.row=b,c.__super__.constructor.apply(this,arguments),this.type="generic",this.initialize()}return a(c,b),c}(GridEdit.Cell),GridEdit.HandleCell=function(){function a(a){var b,c,d;this.row=a,c=this.row,d=c.table,this.element=document.createElement("td"),this.element.setAttribute("draggable",!0),this.element.className=d.theme.cells.handleClassName,b=document.createElement("div"),b.innerHTML="<span></span><span></span><span></span>",this.element.appendChild(b),this.element.onclick=function(a){var b;return b=c.index,c.table.selectRow(a,b)},this.element.ondragstart=function(){var a,b,e,f,g;for(c.cells[0].addToSelection(),a=new GridEdit.GridChange(d.activeCells),b=e=f=a.lowRow,g=a.highRow;g>=f?g>=e:e>=g;b=g>=f?++e:--e)d.rows[b].select();return d.contextMenu.hideBorders(),d.draggingRow=a},this.element.ondragend=function(){var a,b,c,e,f;return f=d.draggingRow.lowRow,e=d.draggingRow.highRow-d.draggingRow.lowRow+1,b=d.lastDragOver.index,c=0,0===b?d.lastDragOverIsBeforeFirstRow||0===f||c++:f>b&&c++,a=b+c,d.lastDragOver.element.style.borderBottom=d.lastDragOver.oldBorderBottom,d.lastDragOver.element.style.borderTop=d.lastDragOver.oldBorderTop,d.lastDragOver.element.style.borderTop=d.lastDragOver.oldBorderTop,d.lastDragOver=null,a!==f?d.moveRows(f,a,e,!0):void 0}}return a}()}.call(this),function(){GridEdit.GridChange=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(this.cells=a,p="ge-blank"===b,this.changes=[],this.table=this.cells[0].col.table,this.borderStyle=this.table.theme.cells.selectionBorderStyle,this.highRow=0,this.highCol=0,l=this.cells,h=0,j=l.length;j>h;h++)d=l[h],n=d.address[0],f=d.address[1],o={row:n,col:f,value:p?"":b||d.value()},this.firstCell?o.row<this.firstCell.row?this.firstCell=o:o.row===this.firstCell.row&&o.col<this.firstCell.col&&(this.firstCell=o):(this.firstCell=o,this.lowRow=o.row,this.lowCol=o.col),o.row>this.highRow&&(this.highRow=o.row),o.col>this.highCol&&(this.highCol=o.col),o.row<this.lowRow&&(this.lowRow=o.row),o.col<this.lowCol&&(this.lowCol=o.col),this.changes.push(o);for(m=this.changes,i=0,k=m.length;k>i;i++)e=m[i],e.rowVector=e.row-this.firstCell.row,e.colVector=e.col-this.firstCell.col;q=this.highCol-this.lowCol+1,g=this.highRow-this.lowRow+1,c=q*g,this.scattered=this.cells.length!==c}return a.prototype.applyTo=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(c=this.changes[0].value,a.scattered)return a.fill(c),"pasteGrid";if(d=this.width(),b=this.height(),l=a.width(),k=a.height(),d>l||b>k)return q=a.firstCell.row,r=a.firstCell.col,this.apply(q,r),"copyGrid";for(p=parseInt(l/d),o=parseInt(k/b),q=a.firstCell.row,r=a.firstCell.col,g=i=0,m=o;m>=0?m>i:i>m;g=m>=0?++i:--i)for(e=q+g*b,h=j=0,n=p;n>=0?n>j:j>n;h=n>=0?++j:--j)f=r+h*d,this.apply(e,f);return"pasteGrid"},a.prototype.copyValues=function(){var a,b,c,d,e,f,g,h;for(g=this.firstCell.row,h=this.firstCell.col,e=this.changes,f=[],c=0,d=e.length;d>c;c++)b=e[c],a=this.table.getCell(g+b.rowVector,h+b.colVector),f.push(a&&a.editable?b.oldValue=a.value():void 0);return f},a.prototype.width=function(){return this.highCol-this.lowCol+1},a.prototype.height=function(){return this.highRow-this.lowRow+1},a.prototype.fill=function(a){var b,c,d,e,f,g,h,i;for(h=this.firstCell.row,i=this.firstCell.col,f=this.changes,g=[],d=0,e=f.length;e>d;d++)c=f[d],b=this.table.getCell(h+c.rowVector,i+c.colVector),b&&b.editable?(c.oldValue=b.value(),g.push(b.value(a,!1))):g.push(c.oldValue="");return g},a.prototype.apply=function(a,b){var c,d,e,f,g,h;for((a===!1||b===!1)&&(a=this.firstCell.row,b=this.firstCell.col),g=this.changes,h=[],e=0,f=g.length;f>e;e++)d=g[e],c=this.table.getCell(a+d.rowVector,b+d.colVector),c&&c.editable?(d.oldValue=c.value(),h.push(c.value(d.value,!1))):h.push(d.oldValue="");return h},a.prototype.undo=function(a,b){var c,d,e,f,g,h;for((a===!1||b===!1)&&(a=this.firstCell.row,b=this.firstCell.col),g=this.changes,h=[],e=0,f=g.length;f>e;e++)d=g[e],c=this.table.getCell(a+d.rowVector,b+d.colVector),h.push(c&&c.editable?c.value(d.oldValue,!1):void 0);return h},a.prototype.displayBorders=function(){var a,b,c,d,e;for(d=this.cells,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.addBorder(a));return e},a.prototype.removeBorders=function(){var a,b,c,d,e;for(d=this.cells,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.element.style.border="");return e},a.prototype.addBorder=function(a){var b,c;return c=a.address[0],b=a.address[1],this.scattered?a.element.style.border=this.borderStyle:(this.firstCell.row===this.highRow?(a.element.style.borderTop=this.borderStyle,a.element.style.borderBottom=this.borderStyle):c===this.lowRow?a.element.style.borderTop=this.borderStyle:c===this.highRow&&(a.element.style.borderBottom=this.borderStyle),this.firstCell.col===this.highCol?(a.element.style.borderRight=this.borderStyle,a.element.style.borderLeft=this.borderStyle):b===this.lowCol?a.element.style.borderLeft=this.borderStyle:b===this.highCol?a.element.style.borderRight=this.borderStyle:void 0)},a}()}.call(this),function(){GridEdit.Theme=function(){function a(a,b){switch(this.themeName=a,this.themeName){case"bootstrap":this.apply(this.bootstrap);break;default:this.themeName="default",this.apply(this["default"])}b&&(this.themeName=this.themeName+"-custom",this.apply(b))}return a.prototype.apply=function(a){var b,c,d,e,f;e=this,b=function(a,c){var d,e,f;e=[];for(d in c)f=c[d],"object"==typeof f?(a[d]||(a[d]={}),e.push(b(a[d],f))):e.push(a[d]=f);return e},d=[];for(c in a)f=a[c],"object"==typeof f?(e[c]||(e[c]={}),d.push(b(e[c],f))):d.push(e[c]=f);return d},a.prototype["default"]={bootstrap:!1,cells:{activeColor:"#FFE16F",uneditableColor:"#FFBBB3",handleClassName:"handle",selectionBorderStyle:"2px dashed blue"},borders:{dragBorderStyle:"3px solid rgb(160, 195, 240)"},inputs:{textarea:{className:"grid-edit"},select:{className:"grid-edit"},checkbox:{checkedClassName:!1,uncheckedClassName:!1}}},a.prototype.bootstrap={bootstrap:!0,cells:{activeColor:"#FFE16F",uneditableColor:"#FFBBB3",handleClassName:"handle",selectionBorderStyle:"2px dashed blue"},borders:{dragBorderStyle:"3px solid rgb(160, 195, 240)"},inputs:{textarea:{className:"form-control"},select:{className:"form-control"},checkbox:{checkedClassName:"glyphicon glyphicon-check",uncheckedClassName:"glyphicon glyphicon-unchecked"}}},a}()}.call(this),function(){GridEdit.Hook=function(){function a(){}return a.prototype.run=function(a,b){var c,d,e,f,g;if(a[b]){for(d=[],e=f=0,g=arguments.length;g>f;e=++f)c=arguments[e],2>e||d.push(c);return a[b].apply(a,d)!==!1}return!0},a.prototype.initTableHooks=function(a){var b;return b=a.config,a.beforeMoveRow=b.beforeMoveRow,a.afterMoveRow=b.afterMoveRow,a.beforeMoveRows=b.beforeMoveRows,a.afterMoveRows=b.afterMoveRows,a.beforeAddRow=b.beforeAddRow,a.afterAddRow=b.afterAddRow,a.beforeAddRows=b.beforeAddRows,a.afterAddRows=b.afterAddRows,a.beforeRemoveRow=b.beforeRemoveRow,a.afterRemoveRow=b.afterRemoveRow,a.beforeRemoveRows=b.beforeRemoveRows,a.afterRemoveRows=b.afterRemoveRows,a.beforeInsertBelow=b.beforeInsertBelow,a.afterInsertBelow=b.afterInsertBelow,a.beforeInsertAbove=b.beforeInsertAbove,a.afterInsertAbove=b.afterInsertAbove},a.prototype.initContextMenuHooks=function(a){var b;return b=a.table.config,a.beforeContextMenuAction=b.beforeContextMenuAction,a.afterContextMenuAction=b.afterContextMenuAction},a.prototype.initCellHooks=function(a){var b;return b=a.table.config,a.beforeEdit=b.beforeEdit,a.afterEdit=b.afterEdit,a.beforeActivate=b.beforeCellActivate,a.afterActivate=b.afterCellActivate,a.beforeControlInit=b.beforeControlInit,a.afterControlInit=b.afterControlInit,a.beforeControlHide=b.beforeControlHide,a.afterControlHide=b.afterControlHide,a.beforeNavigateTo=b.beforeCellNavigateTo,a.onClick=b.onCellClick,a.onDblClick=b.onCellDblClick},a}()}.call(this);