(function(){var Cell,Column,ContextMenu,GridEdit,Row,Utilities,root,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};Utilities=function(){function a(){}return a.prototype.setAttributes=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(d?a.setAttribute(c,d):void 0);return e},a.prototype.setStyles=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(a.style[c]=""+d+"px");return e},a.prototype.clearActiveCells=function(a){var b,c,d,e,f,g,h,i,j;if(f=a.redCells,c=a.activeCells,f.length>0){for(d=g=0,i=f.length;i>g;d=++g)e=f[d],null!=e&&e.makeInactive();a.redCells=[]}if(c.length>0){for(d=h=0,j=c.length;j>h;d=++h)b=c[d],null!=b&&b.makeInactive(),null!=b&&b.hideControl();a.activeCells=[]}return a.selectionStart=null,a.selectionEnd=null,a.contextMenu.hide(),a.selectedCol?a.selectedCol.makeInactive():void 0},a.prototype.capitalize=function(a){return a.toLowerCase().replace(/\b./g,function(a){return a.toUpperCase()})},a}(),GridEdit=function(){function a(a){var b,c,d;if(this.config=a,this.element=document.querySelectorAll(this.config.element||"#gridedit")[0],this.headers=[],this.rows=[],this.cols=[],this.source=this.config.rows,this.redCells=[],this.activeCells=[],this.copiedCells=[],this.copiedValues=[],this.selectionStart=null,this.selectionEnd=null,this.selectedCol=null,this.openCell=null,this.state="ready",this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.topOffset=this.config.topOffset?this.config.topOffset:0,this.formulaTriggerKeys=[],this.cellStyles={activeColor:"#FFE16F",uneditableColor:"#FFBBB3"},this.config.custom){d=this.config.custom;for(b in d)c=d[b],b in this.config.custom&&this.set(b,c);delete this.config.custom}this.config.initialize&&this.init(),this.contextMenu=new ContextMenu(["cut","copy","paste","undo","fill"],this)}return a.prototype.init=function(){this.config.beforeInit&&this.config.beforeInit(),this.build(),this.events(),this.render(),this.config.afterInit&&this.config.afterInit()},a.prototype.build=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;for(i=document.createElement("tr"),n=this.config.cols,c=j=0,l=n.length;l>j;c=++j)b=n[c],a=new Column(b,this),this.cols.push(a),i.appendChild(a.element);for(h=document.createElement("thead"),h.appendChild(i),g=document.createElement("tbody"),o=this.source,c=k=0,m=o.length;m>k;c=++k)e=o[c],d=new Row(e,this),this.rows.push(d),g.appendChild(d.element);return f=document.createElement("table"),Utilities.prototype.setAttributes(f,{id:"editable-grid","class":this.config.tableClass}),f.appendChild(h),f.appendChild(g),this.tableEl=f},a.prototype.rebuild=function(a){var b,c;if(null==a&&(a=null),b=Object.create(this.config),null!==a)for(c in a)a[c]&&(b[c]=a[c]);return this.destroy(),this.constructor(b)},a.prototype.events=function(){var a,b,c;return c=this,b=c.moveTo,a=c.edit,document.onkeydown=function(d){var e,f,g,h,i,j;if(c.activeCell())switch(g=d.keyCode,i=d.shiftKey,f=d.ctrlKey,e=d.metaKey,j=function(a,b){var c;return c=String.fromCharCode(a),b?c:c.toLowerCase()},h=function(){return c.openCell?void 0:c.activeCell().showControl(j(g,i))},g){case 39:if(!c.activeCell().isBeingEdited())return b(c.nextCell());break;case 9:return b(i?c.previousCell():c.nextCell());case 37:return b(c.previousCell());case 38:return b(c.aboveCell());case 40:return b(c.belowCell());case 32:if(!c.openCell)return a(c.activeCell());break;case 67:return e||f?c.contextMenu.copy():h();case 86:return e||f?c.contextMenu.paste():h();case 88:return e||f?c.contextMenu.cut():h();case 90:return e||f?c.contextMenu.undo():h();case 13:break;case 16:break;case 17:break;case 91:break;case 8:if(!c.openCell)return d.preventDefault(),c["delete"]();break;case 46:if(!c.openCell)return d.preventDefault(),c["delete"]();break;default:return __indexOf.call([96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111],g)>=0&&(g-=48),h()}},window.onresize=function(){return c.openCell?Utilities.prototype.setStyles(c.openCell.control,c.openCell.position()):void 0},window.onscroll=function(){return c.openCell?c.openCell.reposition():void 0},this.tableEl.oncontextmenu=function(){return!1},document.onclick=function(a){var b;return c.isDescendant(a.target)||a.target===(null!=(b=c.activeCell())?b.control:void 0)?void 0:Utilities.prototype.clearActiveCells(c)}},a.prototype.render=function(){return this.element.hasChildNodes()&&(this.element=document.querySelectorAll(this.config.element||"#gridedit")[0]),this.element.appendChild(this.tableEl)},a.prototype.set=function(a,b){return void 0!==a?this.config[a]=b:void 0},a.prototype.getCell=function(a,b){return this.rows[a].cells[b]},a.prototype.activeCell=function(){return this.activeCells.length>1?this.activeCells:this.activeCells[0]},a.prototype.nextCell=function(){var a;return null!=(a=this.activeCell())?a.next():void 0},a.prototype.previousCell=function(){var a;return null!=(a=this.activeCell())?a.previous():void 0},a.prototype.aboveCell=function(){var a;return null!=(a=this.activeCell())?a.above():void 0},a.prototype.belowCell=function(){var a;return null!=(a=this.activeCell())?a.below():void 0},a.prototype.moveTo=function(a,b){var c,d,e,f,g;return a&&(void 0===b&&(b=a.table.activeCell()),d=a.table.getDirection(b,a),a.beforeNavigateTo&&(c=a.beforeNavigateTo(a,b,d)),c!==!1&&(a.isVisible()||(g=a.table.activeCell().address[0],f=a.address[0],e=1,g>f&&(e=-1),window.scrollBy(0,(null!=a?a.position().height:void 0)*e)),a.makeActive())),!1},a.prototype.getDirection=function(a,b){var c,d,e,f,g;return e=a.address[0],g=b.address[0],d=a.address[1],f=b.address[1],e===g?d>f?c="left":f>d?c="right":console.log("Cannot calculate direction going from cell "+a.address+" to cell "+b.address):e>g?c="up":g>e?c="down":console.log("Cannot calculate direction going from cell "+a.address+" to cell "+b.address),c},a.prototype.edit=function(a,b){return null==b&&(b=null),null!==b?null!=a?a.edit(b):void 0:(null!=a&&a.edit(),!1)},a.prototype["delete"]=function(){var a,b,c,d,e;for(d=this.activeCells,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.value(""));return e},a.prototype.clearActiveCells=function(){return Utilities.prototype.clearActiveCells(this)},a.prototype.setSelection=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.selectionStart!==this.selectionEnd){for(l=this.activeCells,f=0,h=l.length;h>f;f++)a=l[f],a.removeFromSelection();for(this.activeCells=[],e=function(){o=[];for(var a=m=this.selectionStart.address[0],b=this.selectionEnd.address[0];b>=m?b>=a:a>=b;b>=m?a++:a--)o.push(a);return o}.apply(this),c=function(){p=[];for(var a=n=this.selectionStart.address[1],b=this.selectionEnd.address[1];b>=n?b>=a:a>=b;b>=n?a++:a--)p.push(a);return p}.apply(this),g=0,i=e.length;i>g;g++)for(d=e[g],k=0,j=c.length;j>k;k++)b=c[k],this.rows[d].cells[b].addToSelection()}},a.prototype.data=function(){var a,b,c,d,e,f,g,h,i,j;for(b=[],i=this.rows,e=0,g=i.length;g>e;e++){for(c=i[e],d=[],j=c.cells,f=0,h=j.length;h>f;f++)a=j[f],d.push("date"===a.type?a.control.valueAsDate:a.value());b.push(d)}return b},a.prototype.repopulate=function(){var a,b,c,d,e,f;for(e=this.rows,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(function(){var c,d,e,f;for(e=b.cells,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(a.value(a.source[a.valueKey]));return f}());return f},a.prototype.destroy=function(){var a,b;this.element.removeChild(this.tableEl),b=[];for(a in this)b.push(delete this[a]);return b},a.prototype.isDescendant=function(a){var b;for(b=a.parentNode;null!=b;){if(b===this.tableEl)return!0;b=b.parentNode}return!1},a}(),Column=function(){function a(a,b){var c,d,e;this.attributes=a,this.table=b,this.id=this.index=this.table.cols.length,this.cells=[],this.element=document.createElement("th"),this.textNode=document.createTextNode(this.attributes.label),this.element.appendChild(this.textNode),e=this.attributes;for(c in e)d=e[c],this[c]=d;delete this.attributes,this.events()}return a.prototype.next=function(){return this.table.cols[this.index+1]},a.prototype.previous=function(){return this.table.cols[this.index-1]},a.prototype.makeActive=function(){return this.element.classList.add("active"),this.table.selectedCol=this},a.prototype.makeInactive=function(){return this.element.classList.remove("active"),this.table.selectedCol=null},a.prototype.events=function(){var a,b;return a=this,b=a.table,this.element.onclick=function(){var c,d,e,f,g;for(Utilities.prototype.clearActiveCells(b),a.makeActive(),f=a.cells,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.addToSelection());return g},this.element.onmousedown=function(c){return 3===c.which?void b.contextMenu.show(c.x,c.y,a.cells[0]):!1}},a}(),Row=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(this.attributes=a,this.table=b,this.id=this.table.rows.length,this.cells=[],this.formulaCells=[],this.index=this.table.rows.length,this.element=document.createElement("tr"),this.editable=!0,Utilities.prototype.setAttributes(this.element,{id:"row-"+this.id}),n=this.table.cols,f=h=0,k=n.length;k>h;f=++h)for(e=n[f],"formula"===e.type?(c=new Cell(e.formula,this),this.formulaCells.push(c)):c=new Cell(this.attributes[e.valueKey],this),this.cells.push(c),this.table.cols[f].cells.push(c),this.element.appendChild(c.element),o=this.formulaCells,i=0,l=o.length;l>i;i++)for(c=o[i],p=c.getFormulaKeys(),j=0,m=p.length;m>j;j++)d=p[j],g=this.getCellByValueKey(d),g.dependantFormulaCells.push(c);delete this.attributes}return a.prototype.below=function(){return this.table.rows[this.index+1]},a.prototype.above=function(){return this.table.rows[this.index-1]},a.prototype.getCellByValueKey=function(a){var b,c,d,e,f;for(c=void 0,f=this.cells,d=0,e=f.length;e>d;d++)b=f[d],b.valueKey===a&&(c=b);return c},a}(),Cell=function(){function Cell(a,b){var c,d,e,f;if(this.attributes=a,this.row=b,this.id=""+this.row.id+"-"+this.row.cells.length,this.address=[this.row.id,this.row.cells.length],this.index=this.row.cells.length,this.table=this.row.table,this.col=this.table.cols[this.index],this.type=this.col.type,this.meta=this.col,this.source=this.table.config.rows[this.address[0]],this.valueKey=this.col.valueKey,this.element=document.createElement("td"),this.previousValue=null,"formula"===this.type?(this.formula=this.attributes,this.originalValue=this.getFormulaResults()):this.originalValue=this.attributes,this.editable="editable"in this.col?this.col.editable:"formula"===this.type?!1:!0,this.val=this.originalValue,this.values=[this.originalValue],"formula"!==this.type&&(this.dependantFormulaCells=[]),this.initCallbacks(),Utilities.prototype.setAttributes(this.element,{id:"cell-"+this.id,"class":(null!=(e=this.originalValue)?e["class"]:void 0)||"",style:(null!=(f=this.originalValue)?f.styles:void 0)||""}),this.col.style)for(d in this.col.style)this.element.style[d]=this.col.style[d];switch(this.type){case"string":c=document.createTextNode(this.originalValue),this.control=document.createElement("input");break;case"number":c=document.createTextNode(this.originalValue),this.control=document.createElement("input");break;case"date":c=document.createTextNode(this.toDateString(this.originalValue)),this.control=this.toDate(),this.originalValue&&(this.control.valueAsDate=new Date(this.originalValue));break;case"html":this.htmlContent=this.originalValue,c=this.toFragment(),this.control=document.createElement("input");break;case"select":c=document.createTextNode(this.originalValue||""),this.control=this.toSelect();break;case"formula":c=document.createTextNode(this.originalValue),this.control=document.createElement("input")}this.element.appendChild(c),delete this.attributes,this.events(this)}return Cell.prototype.initCallbacks=function(){return this.table.config.beforeEdit&&(this.beforeEdit=this.table.config.beforeEdit),this.table.config.afterEdit&&(this.afterEdit=this.table.config.afterEdit),this.table.config.beforeCellActivate&&(this.beforeActivate=this.table.config.beforeCellActivate),this.table.config.afterCellActivate&&(this.afterActivate=this.table.config.afterCellActivate),this.table.config.beforeControlInit&&(this.beforeControlInit=this.table.config.beforeControlInit),this.table.config.afterControlInit&&(this.afterControlInit=this.table.config.afterControlInit),this.table.config.beforeControlHide&&(this.beforeControlHide=this.table.config.beforeControlHide),this.table.config.afterControlHide&&(this.afterControlHide=this.table.config.afterControlHide),this.table.config.onCellClick&&(this.onClick=this.table.config.onCellClick),this.table.config.beforeCellNavigateTo?this.beforeNavigateTo=this.table.config.beforeCellNavigateTo:void 0},Cell.prototype.setNewHTMLValue=function(a){var b;return this.htmlContent=a,b=this.toFragment(),this.element.innerHTML="",this.element.appendChild(b)},Cell.prototype.value=function(a){var b,c,d,e,f;if(null==a&&(a=null),null!==a&&a!==this.element.textContent){if("date"===this.type?a.length>0?a=this.toDateString(Date.parse(a)):a instanceof Date?a=this.toDateString(a):0===a.length&&(a="",this.control.valueAsDate=null):"number"===this.type&&(a=0===a.length?null:Number(a)),c=this.value(),this.beforeEdit&&this.beforeEdit(this,c,a),this.previousValue=this.element.textContent,this.values.push(a),this.element.textContent=a,"number"===this.type?this.source[this.valueKey]=Number(a):"date"===this.type?(this.source[this.valueKey]=new Date(a),this.control.valueAsDate=new Date(a)):"html"===this.type?this.setNewHTMLValue(a):this.source[this.valueKey]=a,Utilities.prototype.setStyles(this.control,this.position()),"formula"!==this.type)for(f=this.dependantFormulaCells,d=0,e=f.length;e>d;d++)b=f[d],b.runFormula();return this.afterEdit&&this.afterEdit(this,c,a,this.table.contextMenu.getTargetPasteCell()),a}return"html"!==this.type?this.element.textContent:this.htmlContent},Cell.prototype.getFormulaResults=function(){var evalFormula,key,value,_ref;evalFormula=this.formula,_ref=this.source;for(key in _ref)value=_ref[key],this.formula.indexOf(key)>-1&&(-1===this.table.formulaTriggerKeys.indexOf(key)&&this.table.formulaTriggerKeys.push(key),evalFormula=evalFormula.replace(key,value));return eval(evalFormula)},Cell.prototype.getFormulaKeys=function(){var a,b,c,d;a=[],d=this.source;for(b in d)c=d[b],this.formula.indexOf(b)>-1&&a.push(b);return a},Cell.prototype.runFormula=function(){return this.value(this.getFormulaResults())},Cell.prototype.isFormulaKey=function(){return this.table.formulaTriggerKeys.indexOf(this.valueKey)>-1},Cell.prototype.makeActive=function(){var a;return this.beforeActivate&&(a=this.beforeActivate(this)),(this.beforeActivate&&a!==!1||!this.beforeActivate)&&(Utilities.prototype.clearActiveCells(this.table),this.showActive(),this.table.activeCells.push(this),this.table.selectionStart=this,this.table.openCell&&this.table.openCell.edit(this.table.openCell.control.value),this.afterActivate)?this.afterActivate(this):void 0},Cell.prototype.makeInactive=function(){return this.showInactive()},Cell.prototype.addToSelection=function(){return this.showActive(),this.table.activeCells.push(this)},Cell.prototype.isActive=function(){return-1!==this.table.activeCells.indexOf(this)},Cell.prototype.removeFromSelection=function(){return this.showInactive()},Cell.prototype.showActive=function(){var a;return a=this.element.style.cssText,this.oldCssText=a,this.element.style.cssText=a+" "+("background-color: "+this.table.cellStyles.activeColor+";")},Cell.prototype.showInactive=function(){return this.element.style.cssText=this.oldCssText},Cell.prototype.showRed=function(){return this.element.style.cssText="background-color: "+this.table.cellStyles.uneditableColor+";",this.table.redCells.push(this)},Cell.prototype.showControl=function(a){var b,c,d;return null==a&&(a=null),this.table.contextMenu.borderedCells.length>0&&this.table.contextMenu.hideBorders(),this.editable?(this.beforeControlInit&&(b=this.beforeControlInit(this)),(this.beforeControlInit&&b!==!1||!this.beforeControlInit)&&(null!==a?(this.control.value=a,d=this.control,setTimeout(function(){return d.focus()},0)):"select"===this.type?(this.control=this.toSelect(),c=this,this.control.onchange=function(a){return c.edit(a.target.value)}):this.control.value=this.value(),"date"===this.type&&(this.control.value=this.toDateInputString(this.value())),this.control.style.position="fixed",Utilities.prototype.setStyles(this.control,this.position()),this.table.element.appendChild(this.control),this.table.openCell=this,this.afterControlInit)?this.afterControlInit(this):void 0):this.showRed()},Cell.prototype.hideControl=function(){var a;return null!==this.table.openCell&&(this.beforeControlHide&&(a=this.beforeControlHide(this)),(this.beforeControlHide&&a!==!1||!this.beforeControlHide)&&this.isControlInDocument()&&this.control.remove(),this.table.openCell=null,this.afterControlHide)?this.afterControlHide(this):void 0},Cell.prototype.edit=function(a){return null==a&&(a=null),this.editable?null!==a?(this.value(a),this.isBeingEdited()?this.hideControl():this.edit()):(this.showControl(),this.control.focus(),"select"!==this.type?this.control.select():void 0):this.showRed()},Cell.prototype.position=function(){return this.element.getBoundingClientRect()},Cell.prototype.isVisible=function(){var a;return a=this.position(),a.top>=this.table.topOffset&&a.bottom<=window.innerHeight},Cell.prototype.isControlInDocument=function(){return null!==this.control.parentNode},Cell.prototype.reposition=function(){return Utilities.prototype.setStyles(this.control,this.position())},Cell.prototype.next=function(){var a;return this.row.cells[this.index+1]||(null!=(a=this.row.below())?a.cells[0]:void 0)},Cell.prototype.previous=function(){var a;return this.row.cells[this.index-1]||(null!=(a=this.row.above())?a.cells[this.row.cells.length-1]:void 0)},Cell.prototype.above=function(){var a;return null!=(a=this.row.above())?a.cells[this.index]:void 0},Cell.prototype.below=function(){var a;return null!=(a=this.row.below())?a.cells[this.index]:void 0},Cell.prototype.isBefore=function(a){return a.address[0]===this.address[0]&&a.address[1]>this.address[1]},Cell.prototype.isAfter=function(a){return a.address[0]===this.address[0]&&a.address[1]<this.address[1]},Cell.prototype.isAbove=function(a){return a.address[0]>this.address[0]&&a.address[1]===this.address[1]},Cell.prototype.isBelow=function(a){return a.address[0]<this.address[0]&&a.address[1]===this.address[1]},Cell.prototype.addClass=function(a){return this.element.classList.add(a)},Cell.prototype.removeClass=function(a){return this.element.classList.remove(a)},Cell.prototype.toFragment=function(){var a,b;return a=document.createElement("div"),b=document.createDocumentFragment(),a.innerHTML=this.htmlContent,b.appendChild(a.firstChild||document.createTextNode("")),b},Cell.prototype.toSelect=function(){var a,b,c,d,e,f,g,h,i,j;for(d=document.createElement("select"),this.meta.choices||console.log("There is not a 'choices' key in cell "+this.address+" and you specified that it was of type 'select'"),j=this.meta.choices,f=0,h=j.length;h>f;f++){if(a=j[f],c=document.createElement("option"),a instanceof Array)for(b=g=0,i=a.length;i>g;b=++g)e=a[b],0===b&&(c.value=e),1===b&&(c.text=e);else c.value=c.text=a;this.value()===a&&(c.selected=!0),d.add(c)}return d.classList.add("form-control"),d},Cell.prototype.toDateString=function(a){var b;return null==a&&(a=null),a&&""!==a?b=new Date(a):this.value()&&(b=new Date(this.value())),b instanceof Date?("0"+(b.getMonth()+1)).slice(-2)+"-"+("0"+b.getDate()).slice(-2)+"-"+b.getFullYear():""},Cell.prototype.toDate=function(){var a;return a=document.createElement("input"),a.type="date",a.value=this.toDateString(),a},Cell.prototype.toDateInputString=function(a){var b;return null==a&&(a=null),a&&""!==a?b=new Date(a):this.value()&&(b=new Date(this.value())),b instanceof Date?b.getFullYear()+"-"+("0"+(b.getMonth()+1)).slice(-2)+"-"+("0"+b.getDate()).slice(-2):""},Cell.prototype.isBeingEdited=function(){return null!=this.control.parentNode},Cell.prototype.events=function(a){var b,c,d,e;return e=a.table,c=e.redCells,b=e.activeCells,this.element.onclick=function(b){var c;return a.onClick&&(c=a.onClick(a,b)),c===!1?!1:void 0},this.element.ondblclick=function(){return a.edit()},this.element.onmousedown=function(b){return 3===b.which?void e.contextMenu.show(b.x,b.y,a):(e.state="selecting",a.makeActive(),!1)},this.element.onmouseover=function(){return"selecting"===e.state?(e.selectionEnd=a,e.setSelection()):void 0},this.element.onmouseup=function(b){return 3!==b.which?(e.selectionEnd=a,e.setSelection(),e.state="ready"):void 0},this.control.onkeydown=function(b){var c,d;switch(c=b.which){case 13:return a.edit(this.value),null!=(d=a.below())?d.makeActive():void 0}},("select"===this.type||"date"===this.type)&&(this.control.onchange=function(b){return a.edit(b.target.value)}),e.mobile?(d=null,this.element.ontouchstart=function(a){return d=a.changedTouches[0].clientY,Utilities.prototype.clearActiveCells(e),e.openCell?e.openCell.hideControl():void 0},this.element.ontouchend=function(b){var c;return c=b.changedTouches[0].clientY,b.changedTouches.length<2&&c===d?(b.preventDefault(),a.edit()):void 0}):void 0},Cell}(),ContextMenu=function(){function a(a,b){var c,d,e,f,g,h,i,j;for(this.actions=a,this.table=b,this.defaultActions=["cut","copy","paste","undo","fill"],this.element=document.createElement("div"),this.actionNodes={},this.borderedCells=[],Utilities.prototype.setAttributes(this.element,{id:"contextMenu","class":"dropdown clearfix"}),g=document.createElement("ul"),Utilities.prototype.setAttributes(g,{"class":"dropdown-menu",role:"menu","aria-labelledby":"aria-labelledby",style:"display:block;position:static;margin-bottom:5px;"}),j=this.defaultActions,h=0,i=j.length;i>h;h++)d=j[h],f=document.createElement("li"),e=document.createElement("li"),Utilities.prototype.setAttributes(e,{"class":"divider"}),c=document.createElement("a"),c.textContent=Utilities.prototype.capitalize(d),__indexOf.call(this.actions,d)>=0?Utilities.prototype.setAttributes(c,{"class":"enabled",tabIndex:"-1"}):Utilities.prototype.setAttributes(c,{"class":"disabled",tabIndex:"-1"}),"fill"===d&&g.appendChild(e),this.actionNodes[d]=c,f.appendChild(c),g.appendChild(f);this.element.appendChild(g),this.events(this)}return a.prototype.show=function(a,b,c){return c.isActive()||c.makeActive(),this.cells=c.table.activeCells,Utilities.prototype.setStyles(this.element,{left:a,top:b}),this.table.tableEl.appendChild(this.element)},a.prototype.hide=function(){return this.isVisible()?this.table.tableEl.removeChild(this.element):void 0},a.prototype.isVisible=function(){return null!=this.element.parentNode},a.prototype.getTargetPasteCell=function(){return this.table.activeCells.sort(this.sortFunc)[0]},a.prototype.sortFunc=function(a,b){return a.address[0]-b.address[0]},a.prototype.displayBorders=function(){var a,b,c,d,e,f;if(this.borderedCells=this.table.activeCells,this.borderedCells.length>1){for(e=this.borderedCells,f=[],b=c=0,d=e.length;d>c;b=++c)a=e[b],0===b?(a.element.style.borderTop="2px dashed blue",a.element.style.borderLeft="2px dashed blue",f.push(a.element.style.borderRight="2px dashed blue")):b===this.table.activeCells.length-1?(a.element.style.borderBottom="2px dashed blue",a.element.style.borderLeft="2px dashed blue",f.push(a.element.style.borderRight="2px dashed blue")):(a.element.style.borderLeft="2px dashed blue",f.push(a.element.style.borderRight="2px dashed blue"));return f}return this.borderedCells[0].element.style.border="2px dashed blue"},a.prototype.hideBorders=function(){var a,b,c,d,e;for(e=this.borderedCells,b=c=0,d=e.length;d>c;b=++c)a=e[b],a.element.style.border="";return this.borderedCells=[],this.table.copiedValues=[],this.table.copiedCells=[]},a.prototype.cut=function(){var a,b,c,d,e;if(a=this.beforeAction("cut")){for(this.table.copiedValues=[],this.table.copiedCells=this.table.activeCells,e=this.table.activeCells,c=0,d=e.length;d>c;c++)b=e[c],this.table.copiedValues.push(b.value()),b.value("");return this.afterAction("cut")}},a.prototype.copy=function(){var a,b,c,d,e;if(a=this.beforeAction("copy")){for(this.table.copiedValues=[],this.table.copiedCells=this.table.activeCells,e=this.table.activeCells,c=0,d=e.length;d>c;c++)b=e[c],this.table.copiedValues.push(b.value());return this.afterAction("copy")}},a.prototype.paste=function(){var a,b,c,d,e,f,g,h,i,j,k;if(b=this.beforeAction("paste")){if(c=this.getTargetPasteCell(),this.table.copiedValues.length>1)for(j=this.table.copiedValues,d=f=0,h=j.length;h>f;d=++f)e=j[d],c.value(this.table.copiedValues[d]),c=c.below();else for(k=this.table.activeCells,d=g=0,i=k.length;i>g;d=++g)a=k[d],a.value(this.table.copiedValues[0]);return this.afterAction("paste")}},a.prototype.undo=function(){var a,b;return a=this.beforeAction("undo"),a?(b=this.cell.values.pop(),this.cell.value(b),this.afterAction("undo")):void 0},a.prototype.fill=function(){var a,b,c,d,e,f,g;if(a=this.beforeAction("fill")){for(d=this.getTargetPasteCell().value(),g=this.table.activeCells,c=e=0,f=g.length;f>e;c=++e)b=g[c],b.value(d);return this.afterAction("fill")}},a.prototype.beforeAction=function(a){switch(a){case"cut":return!0;case"copy":return!0;case"paste":return this.getTargetPasteCell().editable?!0:!1;case"undo":return!0;case"fill":return this.getTargetPasteCell().editable?!0:!1}},a.prototype.afterAction=function(a){switch(a){case"cut":this.displayBorders();break;case"copy":this.displayBorders();break;case"paste":this.hideBorders();break;case"undo":break;case"fill":}return this.hide()},a.prototype.toggle=function(a){var b;return b=this.actionNodes[a].classList,b.toggle("enabled"),b.toggle("disabled")},a.prototype.events=function(a){return this.element.onclick=function(b){var c;switch(c=b.target.textContent){case"Cut":return a.cut();case"Copy":return a.copy();case"Paste":return a.paste();case"Undo":return a.undo();case"Fill":return a.fill()}}},a}(),root="undefined"!=typeof exports&&null!==exports?exports:window,root.GridEdit=GridEdit}).call(this);